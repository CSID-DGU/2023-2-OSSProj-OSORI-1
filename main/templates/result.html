{% extends 'reference.html' %}
{% block content %}
<div class="lcontainer">

    <!-- 총학점 -->
    <div class="fcontainer">
        <div class="resultbox container0">
            <div class="name name0">
                Total
            </div>
            <div class="box">
                <div class="chart_box" id="chart0">
                    <strong class="total_strong"></strong>
                </div>
                <div class="Sbox">
                    <div class="gbox total_gbox">
                        <span class="grade Grade">학번</span>
                        <span class="t" id="studentnumber"></span>
                    </div>
                    <div class="gbox total_gbox">
                        <span class="grade Grade">이름</span>
                        <span class="t" id="name"></span>
                    </div>
                    <div class="gbox total_gbox">
                        <span class="grade Grade">총 기준 학점
                        </span>
                        <span class="t" id="totalgrade"></span>
                    </div>
                    <div>
                        <div class="gbox total_gbox">
                            <span class="grade Grade">총 이수 학점
                            </span>

                            <span class="t" id="mytotalgrade"></span>
                        </div>
                    </div>
                    <div>
                        <div class="gbox Gbox total_gbox">
                            <span class="cap"><i class="fas fa-graduation-cap"></i></span>

                            <div class="T" id="cangraduate"> </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="rcontainer">
        <!-- 복필/연선 -->
        {% if exists.multi %}
        <div class="resultbox">
            <div class="name">
                {% if user_info.major_state == '복수전공' %}
                복수전공 필수
                {% else %}
                연계전공 필수
                {% endif %}
            </div>
            <div class="box">
                <div id="chart_multi_me">
                    <strong></strong>
                </div>
                <div class="sbox">
                    <div class="gbox" style="margin-top:-1rem">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade_multi_me"></span>
                    </div>
                    <div class="gbox" style="margin-top:-3rem">
                        <span class="grade">이수 학점</span>
                        <span class="r" id="my_grade_multi_me"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="resultbox">
            <div class="name">
                {% if user_info.major_state == '복수전공' %}
                복수전공 선택
                {% else %}
                연계전공 선택
                {% endif %}
            </div>
            <div class="box">
                <div id="chart_multi_ms">
                    <strong></strong>
                </div>
                <div class="sbox">
                    <div class="gbox" style="margin-top:-1rem">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade_multi_ms"></span>
                    </div>
                    <div class="gbox" style="margin-top:-3rem">
                        <span class="grade" style="letter-spacing: -0.2px;">이수 학점</span>
                        <span class="r" id="my_grade_multi_ms"></span>
                        </div>
                    </div>

                    
                </div>
            </div>
        </div>
        {% endif %}

        {% if major_essential %}
        <!-- 전필 -->
        <div class="resultbox">
            <!-- 타이틀 -->
            <div class="name">
                전공 필수
                <span class="tooltip">
                    <span class='tip_div'>Tip</span>
                </span>
                <!-- 클릭시 툴팁 -->
                <div class="tooltip_text">
                    <p>&#183; 전공필수 과목에서 기준보다 <span class='tooltip_span'>초과되는 학점</span>은 전공선택 학점에 추가됩니다.</p>
                    <p>&#183; 학과에 따라 필수로 들어야하는 전필과목이 있을 수 있습니다. (학과 홈페이지 참조)</p>
                    <p>&#183; 한 가지 조건을 만족했을 경우 통과합니다.</p>
                    <p class='tooltip_sub_p'>1. 전공필수 과목으로 기준학점을 만족해야합니다.</p>
                </div>
            </div>
            <!-- 내용 -->
            <div class="box">
                <!-- 원 그래프 -->
                <div id="chart1">
                    <strong></strong>
                </div>
                <!-- 텍스트 영역 -->
                <div class="sbox">
                    <div class="gbox">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade1"></span>
                    </div>
                    <div class="gbox">
                        <span class="grade">이수 학점</span>
                        <span class="r" id="mygrade1"></span>
                    </div>
                    <button class="rbutton" id="myBtn1">Details</button>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- 전공 -->
        <div class="resultbox">
            <!-- 타이틀 -->
            <div class="name">
                전공
                <span class="tooltip">
                    <span class='tip_div'>Tip</span>
                </span>
                <!-- 클릭시 툴팁 -->
                <div class="tooltip_text">
                    <p>&#183; 학점 계산시 <span class='tooltip_span'>초과된 전필 학점</span>이 있다면 전선 학점에 더해진 뒤 계산됩니다.</p>
                    <p>&#183; 한 가지 조건을 만족했을 경우 통과합니다.</p>
                    <p class='tooltip_sub_p'>1. 전공선택 과목으로 기준학점을 만족해야합니다.</p>
                </div>
            </div>
            <!-- 내용 -->
            <div class="box">
                <div id="chart2">
                    <strong></strong>
                </div>
                <!-- 텍스트 영역 -->
                <div class="sbox">
                    <div class="gbox">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade2"></span>
                    </div>
                    <div class="gbox">
                        <span class="grade" >이수 학점</span>
                        <span class="r" id="mygrade2"></span>
                    </div>
                    <button class="rbutton" id="myBtn2">Details</button>
                </div>
            </div>
        </div>

        <!-- 공통교양 -->
        <div class="resultbox">
            <!-- 타이틀 -->
            <div class="name">
                공통교양
                <span class="tooltip">
                    <span class='tip_div'>Tip</span>
                </span>
                <!-- 클릭시 툴팁 -->
                <div class="tooltip_text">
                    <p>&#183; 한 가지 조건을 만족했을 경우 통과합니다.</p>
                    <p class='tooltip_sub_p'>1. 해당 영역에서 정해진 필수과목을 모두 이수해야합니다.</p>
                    <p class='tooltip_sub_p'>&nbsp;&nbsp;&nbsp;- 필수과목의 이수구분이 <span class='tooltip_span'>변경되어도</span> 필수과목을 이수한 것으로 인정됩니다.</p>
                    <p class='tooltip_sub_p'>&nbsp;&nbsp;&nbsp;- 해당 과목이 폐강된 경우 동일과목으로 대체 이수해야합니다.</p>
                </div>
            </div>
            <!-- 내용 -->
            <div class="box">
                <div id="chart3">
                    <strong></strong>
                </div>
                <!-- 텍스트 영역 -->
                <div class="sbox">
                    <div class="gbox">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade3"></span>
                    </div>
                    <div class="gbox">
                        <span class="grade">이수 학점</span>
                        <span class="r" id="mygrade3"></span>
                    </div>
                    <button class="rbutton" id="myBtn3">Details</button>
                </div>
            </div>
        </div>

        <!-- 학기 -->
        {% if exists.basic or exists.basic_eng %}
        <div class="resultbox">
            <!-- 타이틀 -->
            <div class="name">
                학문기초
                <span class="tooltip">
                    <span class='tip_div'>Tip</span>
                </span>
                <!-- 클릭시 툴팁 -->
                <div class="tooltip_text">
                    <p>&#183; 학문기초는 <span class='tooltip_span'>외국어와 자연과학</span>으로 나뉘어집니다.</p>
                    <p>&#183; 본인의 과에 맞게 영역을 구분하여 검사를 진행합니다.</p>
                    <p>&#183; 공과대 학생들의 msc는 <span class='tooltip_span'>학문기초->자연과학에</span> 해당합니다.</p>
                    <p class='tooltip_sub_p'>1. 해당 영역에서 정해진 필수과목을 모두 이수해야합니다.</p>
                    <p class='tooltip_sub_p'>&nbsp;&nbsp;&nbsp;- <span class='tooltip_span'>기준 학점과 상관없이</span> 필수과목만 모두 이수하면 됩니다.</p>
                    <p class='tooltip_sub_p'>&nbsp;&nbsp;&nbsp;- 필수과목의 이수구분이 <span class='tooltip_span'>변경되어도</span> 필수과목을 이수한 것으로 인정됩니다.</p>
                    <p class='tooltip_sub_p'>&nbsp;&nbsp;&nbsp;- 해당 과목이 폐강된 경우 동일과목으로 대체 이수해야합니다.</p>
                </div>
            </div>
            <!-- 내용 -->
            <div class="box">
                <div id="chart4">
                    <strong></strong>
                </div>
                <!-- 텍스트 영역 -->
                <div class="sbox">
                    <div class="gbox">
                        <span class="grade">기준 학점</span>
                        <span class="r" id="grade4"></span>
                    </div>
                    <div class="gbox">
                        <span class="grade">이수 학점</span>
                        <span class="r" id="mygrade4"></span>
                    </div>
                    <button class="rbutton" id="myBtn4">Details</button>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>


<!-- 추천 모달-->

<!-- 전필 -->
<div id="myModal1" class="modal">
    <div class="modal-content">
        <span class="close" id="close1">&times;</span>
        <br>
        <div style="padding: 1rem; text-align: center;">
            <!-- 추천과목 -->
            <div style="font-size : 1.5rem;"><i class="my_i fas fa-check-circle"></i> 추천과목
            </div>
            <div class="mydiv">같은 학과 사용자들이 가장 많이 수강했던 전필과목 순으로 추천합니다.</div>
            <hr>
            {% if not major_essential.pass %}
            {% if major_essential.recom_selection %}
            <table class="mytable">
                <tr class="myth" style="background-color: #f8f8f8;">
                    <th style="border-right :1px solid #cccccc; width:12%">학수번호</th>
                    <th style="border-right :1px solid #cccccc; width:40%">과목명</th>
                    <th style="border-right :1px solid #cccccc; width:16%">이수구분</th>
                    <th style="border-right :1px solid #cccccc; width:12%">선택영역</th>
                    <th style="border-right :1px solid #cccccc; width:8%">학점</th>
                    <th style="width:12%">수강순위</th>
                </tr>
                {% for a,b in major_essential.recom_selection %}
                <tr class="mytr">
                    <td class="mytd">{{ a.subject_num }}</td>
                    <td class="mytd">{{ a.subject_name }}</td>
                    <td class="mytd">{{ a.classification }}</td>
                    <td class="mytd">{{ a.selection }}</td>
                    <td class="mytd">{{ a.grade|floatformat }}</td>
                    <td class="mytd" style="border-right :0px">{{ b }}</td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
            <div style="color:#888888; margin-top:4rem; margin-bottom:2rem;font-size:1.5rem;">
                😱 죄송합니다... 아직 참조할 수 있는 '{{user_info.major}}'의 데이터가 부족합니다...
            </div>
            {% endif %}
            {% endif %}
            <div class="partdiv">
                {% if major_essential.pass %}
                <span style="color:#17a55e"> 기준 학점을 만족했습니다. </span>
                {% else %}
                <span style="color:#FFA500">{{ major_essential.lack }} 학점이 부족합니다</span>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- 전선 -->
<div id="myModal2" class="modal">
    <div class="modal-content">
        <span class="close" id="close2">&times;</span>
        <br>
        <div class="modal_div">
            <div class="p_div">
                <!-- 추천과목 -->
                <div style="font-size : 1.5rem;"><i class="my_i fas fa-check-circle"></i> 추천과목
                </div>
                <div class="mydiv">같은 학과 사용자들이 가장 많이 수강했던 전선과목 순으로 추천합니다.</div>
                <hr>
                {% if not major_selection.pass %}
                {% if major_selection.recom_selection %}
                <table class="mytable">
                    <tr class="myth" style="background-color: #f8f8f8;">
                        <th style="border-right :1px solid #cccccc; width:12%">학수번호</th>
                        <th style="border-right :1px solid #cccccc; width:40%">과목명</th>
                        <th style="border-right :1px solid #cccccc; width:16%">이수구분</th>
                        <th style="border-right :1px solid #cccccc; width:12%">선택영역</th>
                        <th style="border-right :1px solid #cccccc; width:8%">학점</th>
                        <th style="width:12%">수강순위</th>
                    </tr>
                    {% for a,b in major_selection.recom_selection %}
                    <tr class="mytr">
                        <td class="mytd">{{ a.subject_num }}</td>
                        <td class="mytd">{{ a.subject_name }}</td>
                        <td class="mytd">{{ a.classification }}</td>
                        <td class="mytd">{{ a.selection }}</td>
                        <td class="mytd">{{ a.grade|floatformat }}</td>
                        <td class="mytd" style="border-right :0px">{{ b }}</td>
                    </tr>
                    {% endfor %}
                </table>
                {% else %}
                <div style="color:#888888; margin-top:4rem; margin-bottom:2rem;font-size:1.5rem;">
                    😱 죄송합니다... 아직 참조할 수 있는 '{{user_info.major}}'의 데이터가 부족합니다...
                </div>
                {% endif %}
                {% endif %}
                <div class="partdiv">
                    {% if major_selection.pass %}
                    <span style="color:#17a55e"> 기준 학점을 만족했습니다. </span>
                    {% else %}
                    <span style="color:#FFA500">{{ major_selection.lack }} 학점이 부족합니다</span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 공통교양 추천 모달 -->
<div id="myModal3" class="modal">
    <div class="modal-content">
        <span class="close" id="close3">&times;</span>
        <br>
        <div class="modal_div">
            <div class="p_div">
                <div style="font-size : 1.5rem;"><i class="fas fa-check-circle"></i> 수강영역 현황
                </div>
                <div class="mydiv">'수강영역'을 모두 필수로 이수해야 졸업요건을 충족합니다.</div>
                <hr>
                <table class="mytable" style="padding-bottom:1rem">
                    <tr class="myth" style="background-color: #f8f8f8;">
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.0}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.1}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.2}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.3}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.4}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.5}}
                        </th>
                        <th style="border-right :1px solid #cccccc; width:16%">{{common.standard_part.6}}
                        </th>
                    </tr>
                    <tr class="mytr">
                        {% for check in common.part_check %}
                        {% if check == '이수' %}
                        <td class="mytd" style='color:#17a55e; font-weight: bold;'>
                        {% else %}
                        <td class="mytd">
                        {% endif %}
                            {{ check }}
                        </td>
                        {% endfor %}
                    </tr>
                </table>
                <div class="partdiv">
                    {% if common.pass %}
                    <span style="color:#17a55e">선택영역 조건을 만족하셨습니다</span>
                    {% else %}
                    <span style="color:#FFA500">선택영역이 부족합니다</span>
                    {% endif %}
                </div>
            </div>

            <!-- 추천과목 -->
            {% if not common.pass %}
            <div class="p_div">
                <div style="font-size : 1.5rem;"><i class="my_i fas fa-check-circle"></i> 추천과목
                </div>
                <div class="mydiv">
                    전체 사용자들이 가장 많이 수강했던 교양과목 순으로 추천합니다. (부족한 필수영역을 우선으로 보여줍니다)
                </div>
                <hr>
                <table class="mytable">
                    <tr class="myth" style="background-color: #f8f8f8;">
                        <th style="border-right :1px solid #cccccc; width:12%">학수번호</th>
                        <th style="border-right :1px solid #cccccc; width:40%">과목명</th>
                        <th style="border-right :1px solid #cccccc; width:16%">이수구분</th>
                        <th style="border-right :1px solid #cccccc; width:12%">선택영역</th>
                        <th style="border-right :1px solid #cccccc; width:8%">학점</th>
                        <th style="width:12%">수강순위</th>
                    </tr>
                    {% for a,b in core_selection.recom_selection %}
                    <tr class="mytr">
                        <td class="mytd">{{ a.subject_num }}</td>
                        <td class="mytd">{{ a.subject_name }}</td>
                        <td class="mytd">{{ a.classification }}</td>
                        <td class="mytd">{{ a.selection }}</td>
                        <td class="mytd">{{ a.grade|floatformat }}</td>
                        <td class="mytd" style="border-right :0px">{{ b }}</td>
                    </tr>
                    {% endfor %}
                </table>
                <div class="partdiv">
                    <a href="/statistics/" style="color: rgb(255, 140, 0); text-decoration : underline">더 추천받고 싶다면 클릭! 🚗</a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- 학문기초 추천 모달 -->
<div id="myModal4" class="modal">
    <div class="modal-content">
        <span class="close" id="close4">&times;</span>
        <br>
        <div class="modal_div">
            {% if exists.basic %}
            <!-- 필수과목 -->
            <div class="p_div">
                <div style="font-size : 1.5rem;"><i class="fas fa-check-circle"></i> 필수과목 목록
                </div>
                <div class="mydiv">필수과목을 모두 이수해야 졸업요건을 충족합니다.</div>
                <hr>
                <table class="mytable">
                    <tr class="myth" style="background-color: #f8f8f8;">
                        <th style="border-right :1px solid #cccccc; width:15%">학수번호</th>
                        <th style="border-right :1px solid #cccccc; width:40%">과목명</th>
                        <th style="border-right :1px solid #cccccc; width:15%">이수구분</th>
                        <th style="border-right :1px solid #cccccc; width:15%">선택영역</th>
                        <th style="width:15%">학점</th>
                    </tr>
                    {% for q, c in basic.standard_essential %}
                    {% if c %}
                    <tr class="mytr">
                        {% else %}
                    <tr class="mytr" style="color: #d32f2f">
                        {% endif %}
                        <td class="mytd">{{ q.subject_num }}</td>
                        <td class="mytd">{{ q.subject_name }}</td>
                        <td class="mytd">{{ q.classification }}</td>
                        <td class="mytd">{{ q.selection }}</td>
                        <td class="mytd" style="border-right :0px">{{ q.grade|floatformat }}</td>
                    </tr>
                    {% endfor %}
                </table>
                <div class="partdiv">
                    {% if basic.pass_ess %}
                    <span style="color:#17a55e">필수과목 조건을 만족하셨습니다</span>
                    {% else %}
                    <span style="color:#FFA500">필수과목이 부족합니다</span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}



<!-- js 파트 -->
{% block js_section %}

<!-- 원그래프 js 참조 -->
{% load static %}
<script src="{% static 'js/circle-progress.js' %}"></script>
<script src="{% static 'js/modal.js' %}"></script>

<script>
    // 결과창에서 뒤로가기 버튼 클릭시 무조건 mypage로
    history.pushState(null, null, location.href);
    window.onpopstate = function (event) {
        window.location.href = '/mypage/';
    };

    // 퍼센트화 함수
    function to_percent(my, standard) {
        a = (my / standard) * 100
        if (a > 100) {
            a = 100
        }
        return a;
    }

    // 데이터 바인딩

    // 사용자 정보
    var Studentnumber = '{{user_info.id}}';
    var Name = '{{user_info.name}}';
    // 기준학점
    var Totalgrade = '{{total.standard_num}}';               // 총학점
    var Grade1 = '{{major_essential.standard_num}}';         // 전필
    var Grade2 = '{{major_selection.standard_num}}';         // 전선
    // 사용자 학점
    var Mytotalgrade = '{{total.user_num}}';         // 총학점
    var Mygrade1 = '{{major_essential.user_num}}'    // 전필
    var Mygrade2 = '{{major_selection.user_num}}'    // 전선

    // 이수 학점 퍼센트화
    var pernum0 = to_percent(Mytotalgrade, Totalgrade); // 총학점
    var pernum1 = to_percent(Mygrade1, Grade1);         // 전필
    var pernum2 = to_percent(Number(Mygrade2), Grade2);         // 전선

    // pass 여부
    // 총 검사 결과
    if (pernum0 >= 100) {
        if ('{{total.pass}}' == 1) {
            var Cangraduate = "축하합니다! 졸업 가능합니다!";
            document.querySelector('.T').style.fontSize = '24px';
        }
        // 학점은 만족하나 조건이 안될 경우
        else {
            pernum0 = 99;
            document.querySelector('.cap').style.display = 'none';
            document.querySelector('.T').style.fontSize = '23px';
            var Cangraduate = "영역 기준을 모두 만족하지 못했습니다.";
        }
    } else {
        document.querySelector('.cap').style.display = 'none';
        document.querySelector('.T').style.fontSize = '23px';
        var Cangraduate = "총 기준학점보다 " + (Totalgrade - Mytotalgrade) + "학점이 부족합니다!";
    }
    // id값과 매핑
    document.getElementById("name").innerHTML = Name;
    document.getElementById("studentnumber").innerHTML = Studentnumber;
    document.getElementById("grade1").innerHTML = Grade1;
    document.getElementById("grade2").innerHTML = Grade2;
    document.getElementById("mygrade1").innerHTML = Mygrade1;
    document.getElementById("mygrade2").innerHTML = Mygrade2;
    document.getElementById("mytotalgrade").innerHTML = Mytotalgrade;
    document.getElementById("totalgrade").innerHTML = Totalgrade;
    document.getElementById("cangraduate").innerHTML = Cangraduate;

    // 차트 함수
    var CircleProgress = function (x, y, z) {
        if (x == 100) {
            $(y)
                .circleProgress({
                    value: x / 100,
                    startAngle: 300,
                    size: z,
                    animation: {
                        duration: 2200,
                        easing: "swing"
                    },
                    thickness: 15,
                    fill: {
                        gradient: ["#9ae6b3", "#6aa87f"]
                    }
                })
                .on('circle-animation-progress', function (event, progress, stepValue) {
                    $(this)
                        .find('strong')
                        .html(Math.round(x * progress) + '<i>%</i>');
                });
        } else {
            $(y)
                .circleProgress({
                    value: x / 100,
                    startAngle: 300,
                    size: z,
                    animation: {
                        duration: 2200,
                        easing: "swing"
                    },
                    thickness: 15,
                    fill: {

                        gradient: ["#f5aeb0", "#b06163"]
                    }
                })
                .on('circle-animation-progress', function (event, progress, stepValue) {

                    $(this)
                        .find('strong')
                        .html(Math.round(x * progress) + '<i>%</i>');
                });
        }
    }
    CircleProgress(pernum0, '#chart0', 250);
    CircleProgress(pernum1, '#chart1', 150);
    CircleProgress(pernum2, '#chart2', 150);
    CircleProgress(pernum3, '#chart3', 150);
    CircleProgress(pernum4, '#chart4', 150);
    

    var modal1 = document.getElementById('myModal1');
    var modal2 = document.getElementById('myModal2');
    var modal3 = document.getElementById('myModal3');
    var modal4 = document.getElementById('myModal4');

    var btn1 = document.getElementById("myBtn1");
    var btn2 = document.getElementById("myBtn2");
    var btn3 = document.getElementById("myBtn3");
    var btn4 = document.getElementById("myBtn4");
    
    var span1 = document.getElementById("close1");
    var span2 = document.getElementById("close2");
    var span3 = document.getElementById("close3");
    var span4 = document.getElementById("close4");

    Btnclick(btn1, modal1);
    Btnclick(btn2, modal2);
    Btnclick(btn3, modal3);
    Btnclick(btn4, modal4);

    Spanclick(span1, modal1);
    Spanclick(span2, modal2);
    Spanclick(span3, modal3);
    Spanclick(span4, modal4);

    // 툴팁 함수
    let tooltip_btn = document.querySelectorAll('.tooltip');
    let tooltip_box = document.querySelectorAll('.tooltip_text');
    window.onload = function(){

        for (i = 0; i < tooltip_btn.length; i++) {
            Tooltipeb(tooltip_btn[i], tooltip_box[i]);
        }

        function Tooltipeb(btn, box) {
            btn.addEventListener('click', () => {
                box.classList.toggle('active');
            });
        }
    }
    
    // 모달 밖 클릭시 꺼짐 함수
    window.onclick = function (event) {

        if (event.target == modal1) {
            modal1.style.display = "none";
        }
        if (event.target == modal2) {
            modal2.style.display = "none";
        }
        if (event.target == modal3) {
            modal3.style.display = "none";
        }
        if (event.target == modal4) {
            modal4.style.display = "none";
        }
    }

</script>


<script>
    // 공교 영역 함수
    var Grade3 = '{{common.standard_num}}';
    var Mygrade3 = '{{common.user_num}}';
    var pernum3 = to_percent(Mygrade3, Grade3);

    document.getElementById("grade3").innerHTML = Grade3;
    document.getElementById("mygrade3").innerHTML = Mygrade3;
    var modal3 = document.getElementById('myModal3');
    var btn3 = document.getElementById("myBtn3");
    var span3 = document.getElementById("close3");
    Btnclick(btn3, modal3);
    Spanclick(span3, modal3);

    CircleProgress(pernum3, '#chart3', 150);
</script>

<script>
    // 학기 영역 함수
    var Grade4 = '{{basic.standard_num}}';
    var Mygrade4 = '{{basic.user_num}}';
    var pernum4 = to_percent(Mygrade4, Grade4);
    // 선택영역 패스여부
    var Myarea4;
    if ('{{basic.pass}}' == 1) {
        Myarea4 = "Pass";
    }
    else {
        Myarea4 = "NP";
        if (pernum4 == 100) {
            pernum4 -= 1;
        }
    }
    // 필수과목 패스여부
    var Cs_p;
    if ('{{basic.pass_ess}}' == 1) {
        Cs_p = "Pass";
    }
    else {
        Cs_p = "NP";
        if (pernum4 == 100) {
            pernum4 -= 1;
        }
    }
    document.getElementById("grade4").innerHTML = Grade4;
    document.getElementById("myarea4").innerHTML = Myarea4;
    document.getElementById("mygrade4").innerHTML = Mygrade4;
    document.getElementById("cs_p").innerHTML = Cs_p;
    var modal4 = document.getElementById('myModal4');
    var btn4 = document.getElementById("myBtn4");
    var span4 = document.getElementById("close4");
    Btnclick(btn4, modal4);
    Spanclick(span4, modal4);

    CircleProgress(pernum4, '#chart4', 150);
</script>


{% if exists.multi %}
<script>
    // 연계/복수전공시 차트 함수
    var Grade_multi_me = '{{multi_major_essential.standard_num}}';
    var Grade_multi_ms = '{{multi_major_selection.standard_num}}';
    var Mygrade_multi_me = '{{multi_major_essential.user_num}}';
    var Mygrade_multi_ms = '{{multi_major_selection.user_num}}';

    var pernum_multi_me = to_percent(Mygrade_multi_me, Grade_multi_me);
    var pernum_multi_ms = to_percent(Number(Mygrade_multi_ms), Grade_multi_ms);

    document.getElementById("grade_multi_me").innerHTML = Grade_multi_me;
    document.getElementById("grade_multi_ms").innerHTML = Grade_multi_ms;
    document.getElementById("my_grade_multi_me").innerHTML = Mygrade_multi_me;
    document.getElementById("my_grade_multi_ms").innerHTML = Mygrade_multi_ms;

    CircleProgress(pernum_multi_me, '#chart_multi_me', 150);
    CircleProgress(pernum_multi_ms, '#chart_multi_ms', 150);
</script>
{% endif %}


{% endblock %}